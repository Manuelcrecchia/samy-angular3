<div class="container py-4">
  <div class="d-flex justify-content-start align-items-center mb-3">
    <button class="btn btn-outline-primary rounded-pill" (click)="back()">
      â¬… Torna Indietro
    </button>
  </div>

  <h2 class="text-center mb-4">Gestione Turni</h2>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <button class="btn btn-secondary rounded-pill" (click)="prevDay()">&larr;</button>
    <h4 class="m-0">{{ selectedDate | date: 'fullDate' }}</h4>
    <button class="btn btn-secondary rounded-pill" (click)="nextDay()">&rarr;</button>
  </div>

  <div class="text-center mb-4">
    <button class="btn btn-success rounded-pill" (click)="createShifts()">âž• Crea Turni</button>
  </div>

  <div *ngIf="shifts.length === 0" class="alert alert-info text-center">
    Nessun turno presente per il giorno selezionato.
  </div>

  <ul class="list-group" *ngIf="shifts.length > 0">
    <div *ngFor="let empName of groupedKeys()">
      <h4 class="mt-4">{{ empName.toUpperCase() }} â€“ {{ selectedDate | date: 'EEEE d MMMM y':'':'it-IT' | uppercase }}</h4>
      <ul class="list-group list-group-flush">
        <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let turno of groupedByEmployee[empName]">
          <span>{{ turno.title }} â€” {{ turno.start | date: 'HH:mm' }} - {{ turno.end | date: 'HH:mm' }}</span>
          <span
            *ngIf="turno.keyRequired"
            class="key-icon ms-2"
            (mousedown)="handleMouseDown($event, turno.appointmentId)"
            (mouseup)="hideTooltip()"
            (mouseleave)="hideTooltip()"
          >ðŸ”‘</span>
        </li>
      </ul>
    </div>
  </ul>
</div>

<div
  class="tooltip-popup"
  *ngIf="tooltipVisible"
  [style.top.px]="tooltipTarget?.getBoundingClientRect().bottom + windowRef.scrollY + 5"
  [style.left.px]="tooltipTarget?.getBoundingClientRect().left + windowRef.scrollX"
>
  {{ tooltipText }}
</div>
